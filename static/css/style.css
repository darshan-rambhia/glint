/* ─── Glint — Infrastructure Monitor ─────────────────────────────────────── */

/* ── Design Tokens: Light (Cool Slate) ───────────────────────────────────── */
:root {
  --bg:          #f3f6fb;
  --surface:     #e8edf6;
  --card:        #ffffff;
  --card-2:      #f8fafd;
  --border:      #d0d9e6;
  --border-2:    #bccad8;

  --text:        #182130;
  --text-sub:    #4a6070;
  --text-dim:    #8898a8;

  --accent:      #2878a8;
  --accent-soft: #d8eaf5;
  --accent-text: #1a5a80;

  --ok:          #1f8855;
  --ok-soft:     #d5f0e2;
  --ok-text:     #145c38;
  --warn:        #906018;
  --warn-soft:   #fce8c8;
  --warn-text:   #6a4410;
  --crit:        #b02828;
  --crit-soft:   #fae0e0;
  --crit-text:   #7a1a1a;
  --unk:         #587098;
  --unk-soft:    #dce6f2;
  --unk-text:    #3a5070;

  --bar-bg:      #d8e2ee;
  --r:           8px;
  --r-sm:        5px;
  --shadow:      0 1px 3px rgba(20,40,70,0.08), 0 0 0 1px var(--border);
  --shadow-card: 0 2px 8px rgba(20,40,70,0.07), 0 0 0 1px var(--border);

  --font-ui:   'JetBrains Mono', 'Cascadia Code', monospace;
  --font-data: 'Geist Mono', 'JetBrains Mono', monospace;
}

/* ── Design Tokens: Dark (Warm Nord) ─────────────────────────────────────── */
/* Applied when: OS is dark AND user has not forced light mode              */
@media (prefers-color-scheme: dark) {
  :root:not([data-theme="light"]) {
    --bg:          #222b38;
    --surface:     #293444;
    --card:        #2e3b4e;
    --card-2:      #334252;
    --border:      #3a4c60;
    --border-2:    #4a5e72;

    --text:        #d4dfe8;
    --text-sub:    #7d95a8;
    --text-dim:    #4a6070;

    --accent:      #52a8cc;
    --accent-soft: rgba(82,168,204,0.12);
    --accent-text: #52a8cc;

    --ok:          #6abf84;
    --ok-soft:     rgba(106,191,132,0.12);
    --ok-text:     #6abf84;
    --warn:        #c8a050;
    --warn-soft:   rgba(200,160,80,0.12);
    --warn-text:   #c8a050;
    --crit:        #c05050;
    --crit-soft:   rgba(192,80,80,0.12);
    --crit-text:   #c05050;
    --unk:         #6080a8;
    --unk-soft:    rgba(96,128,168,0.12);
    --unk-text:    #6080a8;

    --bar-bg:      rgba(255,255,255,0.07);
    --shadow:      0 1px 3px rgba(0,0,0,0.3), 0 0 0 1px var(--border);
    --shadow-card: 0 2px 8px rgba(0,0,0,0.3), 0 0 0 1px var(--border);
  }
}

/* Applied when: user has explicitly forced dark mode (overrides OS light) */
:root[data-theme="dark"] {
  --bg:          #222b38;
  --surface:     #293444;
  --card:        #2e3b4e;
  --card-2:      #334252;
  --border:      #3a4c60;
  --border-2:    #4a5e72;

  --text:        #d4dfe8;
  --text-sub:    #7d95a8;
  --text-dim:    #4a6070;

  --accent:      #52a8cc;
  --accent-soft: rgba(82,168,204,0.12);
  --accent-text: #52a8cc;

  --ok:          #6abf84;
  --ok-soft:     rgba(106,191,132,0.12);
  --ok-text:     #6abf84;
  --warn:        #c8a050;
  --warn-soft:   rgba(200,160,80,0.12);
  --warn-text:   #c8a050;
  --crit:        #c05050;
  --crit-soft:   rgba(192,80,80,0.12);
  --crit-text:   #c05050;
  --unk:         #6080a8;
  --unk-soft:    rgba(96,128,168,0.12);
  --unk-text:    #6080a8;

  --bar-bg:      rgba(255,255,255,0.07);
  --shadow:      0 1px 3px rgba(0,0,0,0.3), 0 0 0 1px var(--border);
  --shadow-card: 0 2px 8px rgba(0,0,0,0.3), 0 0 0 1px var(--border);
}

/* ── Reset ────────────────────────────────────────────────────────────────── */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

/* ── Base ─────────────────────────────────────────────────────────────────── */
body {
  font-family: var(--font-ui);
  background: var(--bg);
  color: var(--text);
  line-height: 1.5;
  min-height: 100vh;
  font-size: 14px;
}

/* ── Header ───────────────────────────────────────────────────────────────── */
.header {
  position: sticky;
  top: 0;
  z-index: 100;
  background: var(--card);
  border-bottom: 1px solid var(--border);
  padding: 0 24px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  height: 52px;
  box-shadow: 0 1px 4px rgba(20,40,70,0.06);
}

.header-right {
  display: flex;
  align-items: center;
  gap: 12px;
}

@media (prefers-color-scheme: dark) {
  .header { box-shadow: 0 1px 4px rgba(0,0,0,0.2); }
}

.header-left {
  display: flex;
  align-items: center;
  gap: 10px;
}

.logo {
  font-family: var(--font-ui);
  font-size: 16px;
  font-weight: 700;
  letter-spacing: -0.02em;
  color: var(--text);
  text-decoration: none;
}

.logo-dot { color: var(--accent); }

.header-badge {
  font-family: var(--font-data);
  font-size: 11px;
  font-weight: 500;
  padding: 2px 8px;
  border-radius: 99px;
  background: var(--accent-soft);
  color: var(--accent-text);
}

.last-updated {
  font-family: var(--font-data);
  font-size: 11px;
  color: var(--text-dim);
  display: flex;
  align-items: center;
  gap: 5px;
}

.pulse {
  width: 5px;
  height: 5px;
  border-radius: 50%;
  background: var(--ok);
  display: inline-block;
  flex-shrink: 0;
}

/* ── Nav ──────────────────────────────────────────────────────────────────── */
.nav {
  display: flex;
  gap: 2px;
  margin-left: 16px;
}

.nav-item {
  font-family: var(--font-ui);
  font-size: 13px;
  font-weight: 500;
  padding: 5px 10px;
  border-radius: var(--r-sm);
  color: var(--text-sub);
  text-decoration: none;
  transition: background 0.12s, color 0.12s;
}

.nav-item:hover {
  background: var(--surface);
  color: var(--text);
}

/* ── Theme Switcher ───────────────────────────────────────────────────────── */
.theme-switcher {
  display: flex;
  border: 1px solid var(--border);
  border-radius: var(--r-sm);
  overflow: hidden;
  flex-shrink: 0;
}

.theme-btn {
  font-family: var(--font-ui);
  font-size: 13px;
  line-height: 1;
  padding: 4px 8px;
  background: transparent;
  border: none;
  border-right: 1px solid var(--border);
  color: var(--text-dim);
  cursor: pointer;
  transition: background 0.12s, color 0.12s;
}

.theme-btn:last-child {
  border-right: none;
}

.theme-btn:hover {
  background: var(--surface);
  color: var(--text);
}

/* Active state — driven by data-active attribute set by theme.js */
.theme-switcher[data-active="light"] [data-theme-set="light"],
.theme-switcher[data-active="dark"]  [data-theme-set="dark"],
.theme-switcher[data-active="auto"]  [data-theme-set="auto"] {
  background: var(--accent-soft);
  color: var(--accent-text);
}

/* ── Dashboard Layout ─────────────────────────────────────────────────────── */
.dashboard {
  max-width: 1280px;
  margin: 0 auto;
  padding: 24px;
  display: flex;
  flex-direction: column;
  gap: 20px;
}

/* ── Section (card wrapper) ───────────────────────────────────────────────── */
.section {
  background: var(--card);
  border-radius: var(--r);
  box-shadow: var(--shadow-card);
  overflow: hidden;
}

.section-header {
  padding: 13px 16px;
  border-bottom: 1px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
}

.section-title {
  font-family: var(--font-ui);
  font-size: 13px;
  font-weight: 600;
  color: var(--text);
  letter-spacing: -0.01em;
}

.section-meta {
  font-family: var(--font-data);
  font-size: 11px;
  color: var(--text-sub);
}

.section-label {
  font-family: var(--font-ui);
  font-size: 11px;
  font-weight: 600;
  color: var(--text-sub);
  letter-spacing: 0.01em;
  margin-bottom: 10px;
}

/* ── Nodes List (flat rows, divider style inside section card) ────────────── */
.nodes-list {
  display: flex;
  flex-direction: column;
}

.node-row {
  padding: 12px 16px;
  display: flex;
  align-items: center;
  gap: 16px;
  border-bottom: 1px solid var(--border);
}

.node-row:last-child {
  border-bottom: none;
}

.node-row.node-offline {
  opacity: 0.6;
}

.nr-ident {
  width: 150px;
  flex-shrink: 0;
}

.nr-bars {
  display: flex;
  gap: 12px;
  flex: 1;
  min-width: 0;
}

.nr-stat {
  display: flex;
  flex-direction: column;
  gap: 4px;
  flex: 1;
  min-width: 56px;
}

.nr-stat-top {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
}

.nr-sparklines {
  display: flex;
  gap: 6px;
  flex-shrink: 0;
}

.nr-sparkline {
  width: 72px;
  height: 28px;
  background: var(--surface);
  border-radius: var(--r-sm);
  overflow: hidden;
  position: relative;
}

.nr-sparkline svg.sparkline-svg {
  width: 100%;
  height: 100%;
  display: block;
}

.nr-meta {
  display: flex;
  gap: 16px;
  flex-shrink: 0;
}

.nr-meta-item {
  display: flex;
  flex-direction: column;
  gap: 2px;
  min-width: 48px;
}

/* keep nc-name / nc-host for text styles */
.nc-head {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  gap: 8px;
}

.nc-name {
  font-family: var(--font-ui);
  font-size: 14px;
  font-weight: 600;
  letter-spacing: -0.01em;
  color: var(--text);
}

.nc-host {
  font-family: var(--font-data);
  font-size: 11px;
  color: var(--text-sub);
  margin-top: 2px;
}

/* ── Stat label / value (shared) ─────────────────────────────────────────── */

.stat-key {
  font-family: var(--font-ui);
  font-size: 10px;
  font-weight: 500;
  color: var(--text-sub);
  letter-spacing: 0.01em;
}

.stat-val {
  font-family: var(--font-data);
  font-size: 12px;
  color: var(--text);
}

.stat-extra {
  font-family: var(--font-data);
  font-size: 10px;
  color: var(--text-sub);
}

/* ── Progress Bar ─────────────────────────────────────────────────────────── */
.bar {
  height: 4px;
  border-radius: 99px;
  background: var(--bar-bg);
  overflow: hidden;
}

.bar-fill {
  height: 100%;
  border-radius: 99px;
  transition: width 0.3s ease;
}

.bar-ok   { background: var(--ok); }
.bar-warn { background: var(--warn); }
.bar-crit { background: var(--crit); }

/* ── Node Footer ──────────────────────────────────────────────────────────── */
.nc-foot {
  display: flex;
  justify-content: space-between;
  padding-top: 10px;
  border-top: 1px solid var(--border);
}

.nc-foot-item {
  display: flex;
  flex-direction: column;
  gap: 3px;
}

.nc-foot-key {
  font-family: var(--font-ui);
  font-size: 9px;
  color: var(--text-sub);
  letter-spacing: 0.01em;
}

.nc-foot-val {
  font-family: var(--font-data);
  font-size: 11px;
  color: var(--text-sub);
}

/* ── Sparkline label (rendered by sparkline component) ───────────────────── */
.sparkline-label {
  position: absolute;
  bottom: 2px;
  right: 5px;
  font-family: var(--font-data);
  font-size: 9px;
  color: var(--text-dim);
  letter-spacing: 0.03em;
}

/* ── Status Chips ─────────────────────────────────────────────────────────── */
.chip {
  display: inline-flex;
  align-items: center;
  font-family: var(--font-data);
  font-size: 10px;
  font-weight: 600;
  letter-spacing: 0.04em;
  padding: 2px 7px;
  border-radius: 99px;
  white-space: nowrap;
  flex-shrink: 0;
}

.chip-ok   { background: var(--ok-soft);   color: var(--ok-text); }
.chip-warn { background: var(--warn-soft); color: var(--warn-text); }
.chip-crit { background: var(--crit-soft); color: var(--crit-text); }
.chip-unk  { background: var(--unk-soft);  color: var(--unk-text); }

/* ── Tables ───────────────────────────────────────────────────────────────── */
.table-scroll {
  overflow-y: auto;
  max-height: 460px;
}

.data-table {
  width: 100%;
  border-collapse: collapse;
}

.data-table thead th {
  text-align: left;
  font-family: var(--font-ui);
  font-size: 11px;
  font-weight: 500;
  letter-spacing: 0.01em;
  color: var(--text-sub);
  padding: 10px 16px;
  background: var(--card);
  border-bottom: 1px solid var(--border);
  position: sticky;
  top: 0;
  z-index: 2;
}

/* ── Sortable column headers ──────────────────────────────────────────────── */
.data-table thead th[data-sort-key] {
  cursor: pointer;
  user-select: none;
  white-space: nowrap;
}

.data-table thead th[data-sort-key]:hover {
  color: var(--accent);
}

.data-table thead th[data-sort-key]::after {
  content: '';
  display: inline-block;
  width: 0.9em;
  margin-left: 4px;
  opacity: 0.25;
  font-size: 10px;
}

.data-table thead th.sort-asc::after  { content: '↑'; opacity: 1; color: var(--accent); }
.data-table thead th.sort-desc::after { content: '↓'; opacity: 1; color: var(--accent); }

.data-table tbody tr {
  border-bottom: 1px solid var(--border);
}

.data-table tbody tr:last-child {
  border-bottom: none;
}

.data-table tbody tr:hover {
  background: var(--card-2);
}

.data-table tbody td {
  padding: 9px 16px;
  font-family: var(--font-data);
  font-size: 12px;
  color: var(--text);
  vertical-align: middle;
}

.data-table tbody td.td-name {
  font-family: var(--font-ui);
  font-size: 13px;
  font-weight: 500;
}

.data-table tbody td.td-dim {
  color: var(--text-sub);
  font-size: 11px;
}

.data-table.compact tbody td,
.data-table.compact thead th {
  padding: 6px 12px;
}

/* Stopped/offline rows */
.row-stopped { opacity: 0.5; }

/* Mini inline bar in table cells */
.mini-bar {
  display: flex;
  align-items: center;
  gap: 6px;
}

.mini-bar .bar {
  width: 52px;
  flex-shrink: 0;
}

/* ── Type Pill (vm / ct) ──────────────────────────────────────────────────── */
.tpill {
  display: inline-flex;
  align-items: center;
  font-family: var(--font-data);
  font-size: 10px;
  font-weight: 500;
  padding: 2px 6px;
  border-radius: 99px;
  border: 1px solid currentColor;
}

.tpill-vm { color: var(--accent); opacity: 0.8; }
.tpill-ct { color: var(--unk);    opacity: 0.8; }

/* ── Datastore Rows (flat) ────────────────────────────────────────────────── */
.ds-rows {
  display: flex;
  flex-direction: column;
  padding: 0 16px;
  border-bottom: 1px solid var(--border);
}

.ds-row {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 10px 0;
  border-bottom: 1px solid var(--border);
}

.ds-row:last-child {
  border-bottom: none;
}

.dr-ident {
  width: 180px;
  flex-shrink: 0;
}

.dr-bar-wrap {
  flex: 1;
  min-width: 100px;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.dr-bar-top {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
}

.dr-size {
  font-family: var(--font-data);
  font-size: 12px;
  color: var(--text-sub);
  flex-shrink: 0;
  width: 190px;
  text-align: right;
}

.dr-dedup {
  display: flex;
  gap: 6px;
  align-items: baseline;
  flex-shrink: 0;
}

.ds-name {
  font-family: var(--font-ui);
  font-size: 13px;
  font-weight: 600;
  color: var(--text);
}

.ds-instance {
  font-family: var(--font-data);
  font-size: 11px;
  color: var(--text-sub);
  margin-top: 2px;
}

/* ── Sub-sections (Datastores) ────────────────────────────────────────────── */
.sub-section {
  border-top: 1px solid var(--border);
  background: var(--surface);
}

.sub-section .section-label {
  padding: 10px 16px 6px;
  margin-bottom: 0;
}

/* ── Disk Detail ──────────────────────────────────────────────────────────── */
.disk-detail-row td {
  padding: 0 !important;
  border-bottom: none;
}

.disk-detail {
  background: var(--surface);
  padding: 14px 16px;
  border-top: 1px solid var(--border);
}

.disk-info {
  display: flex;
  gap: 20px;
  font-family: var(--font-data);
  font-size: 12px;
  color: var(--text-sub);
  margin-bottom: 12px;
  flex-wrap: wrap;
}

/* ── Risk Badges ──────────────────────────────────────────────────────────── */
.risk-badge {
  display: inline-block;
  padding: 1px 6px;
  border-radius: var(--r-sm);
  font-family: var(--font-data);
  font-size: 11px;
  font-weight: 600;
}

.risk-low    { color: var(--ok);   background: var(--ok-soft); }
.risk-medium { color: var(--warn); background: var(--warn-soft); }
.risk-high   { color: var(--crit); background: var(--crit-soft); }

/* ── Expand / Details Button ──────────────────────────────────────────────── */
.btn-details {
  font-family: var(--font-ui);
  font-size: 11px;
  font-weight: 500;
  padding: 3px 9px;
  border-radius: var(--r-sm);
  border: 1px solid var(--border);
  background: transparent;
  color: var(--text-sub);
  cursor: pointer;
  transition: background 0.12s, color 0.12s, border-color 0.12s;
}

.btn-details:hover {
  background: var(--surface);
  color: var(--text);
  border-color: var(--border-2);
}

/* ── Empty State ──────────────────────────────────────────────────────────── */
.empty-state {
  text-align: center;
  padding: 40px 24px;
  font-family: var(--font-data);
  font-size: 13px;
  color: var(--text-dim);
}

.empty-state-sm {
  padding: 10px 16px 14px;
  font-family: var(--font-data);
  font-size: 12px;
  color: var(--text-dim);
}

/* ── Utilities ────────────────────────────────────────────────────────────── */
.mono      { font-family: var(--font-data); }
.text-sub  { color: var(--text-sub); }
.text-dim  { color: var(--text-dim); }
.text-ok   { color: var(--ok); }
.text-warn { color: var(--warn); }
.text-crit { color: var(--crit); }

/* ── htmx ─────────────────────────────────────────────────────────────────── */
.htmx-indicator { display: none; }
.htmx-request .htmx-indicator { display: inline; }

/* ── Responsive ───────────────────────────────────────────────────────────── */
@media (max-width: 900px) {
  .dashboard { padding: 16px; }
  .nr-sparklines { display: none; }
  .nr-meta { gap: 10px; }
}

@media (max-width: 640px) {
  .header { padding: 0 16px; }
  .nav { display: none; }
  .dashboard { padding: 12px; gap: 12px; }
  .nr-meta { display: none; }
  .dr-size { display: none; }
  .data-table thead th:nth-child(n+5),
  .data-table tbody td:nth-child(n+5) { display: none; }
}
